---
title: "Sandboxes: How AI Agents Safely Run Untrusted Code"
date: "2025-11-08"
excerpt: "AI agents write code on-the-fly—code you've never seen before. How do you run it safely? I discovered why sandboxes are the critical infrastructure enabling Anthropic's 98.7% efficiency breakthrough."
template: "article"
category: "AI Infrastructure"
---

## The Discovery

I was reading [Anthropic's recent article on code execution with MCP](https://www.anthropic.com/engineering/code-execution-with-mcp)—they achieved a **98.7% reduction in token usage**, which is massive. But throughout the article, one word kept appearing: **sandbox**.

"Code execution in secure sandboxes..."
"Agents write code that runs in a sandbox environment..."
"Sandbox infrastructure enables..."

![Screenshot from Anthropic's article highlighting sandboxing requirements](/images/anthropic-sandbox-mention.png)
*Anthropic's article mentions that "Running agent-generated code requires a secure execution environment with appropriate **sandboxing**, resource limits, and monitoring."*

The concept wasn't explained in detail. It was assumed knowledge. But clearly, it was *critical* to everything they were describing.

Then it hit me: **AI agents write code on-the-fly—code you've never reviewed. How do you run it safely?**

This is fundamentally different from traditional computing. When you deploy your application in a container, you wrote (or at least reviewed) every line of code. You trust it. But AI agents? They generate custom code for each task, seconds before execution. You cannot review it. You cannot trust it by default.

So I went deep. I wanted to understand: What exactly *is* a sandbox? Why does it solve the trust problem? And why does Anthropic—and increasingly, the entire industry—seem to believe this is foundational infrastructure?

Here's what I discovered. And why sandboxes are the critical infrastructure enabling safe AI agent execution.

---

## The Problem AI Created

Here's what changed: **AI agents write code you've never seen.**

When you deploy a normal application, you wrote the code. You tested it. You trust it.

But AI agents? They generate code on-the-fly for each task. You can't review it beforehand. You can't trust it by default.

**Example workflow:**
1. You ask: "Analyze this customer data for trends"
2. Agent writes Python code to do it
3. Agent runs that code immediately
4. You get results

That code could access files it shouldn't, make network calls you didn't authorize, or crash your system. How do you run it safely?

## What IS a Sandbox?

**A sandbox is a secure box where you run code you don't trust.**

Think of a kids' sandbox. They can build anything, make a mess, experiment. The sand stays contained—it doesn't get all over the house. When done, you knock it down and start fresh.

**Same idea for code:**
- Code runs in complete isolation (can't touch your files or system)
- Assume it's hostile (zero-trust)
- Exists only for that one execution (ephemeral)
- You get results back (stdout, stderr, exit code)
- Then it's destroyed

**Real examples you already use:**
- Chrome's sandbox runs untrusted web code safely
- Browser plugins run in sandboxes
- Mobile apps run in sandboxes

For AI agents, companies like Cloudflare and AWS adapted this proven technology.

## Why Not Just Use Docker Containers?

Containers solve a different problem:

| **Containers** | **Sandboxes** |
|----------------|---------------|
| Deploy YOUR apps | Run UNTRUSTED code |
| You wrote the Dockerfile | Assume code is hostile |
| Runs for days/weeks | Runs for milliseconds |
| Examples: Docker, Kubernetes | Examples: Chrome, Cloudflare Workers |

Containers are for code you trust. Sandboxes are for code you don't.

**Anthropic's breakthrough:** Using sandboxes for AI-generated code led to their 98.7% token reduction.

---

## What This Unlocks

With sandboxes, AI agents can:

**Privacy-preserving workflows** - Process sensitive data in the sandbox without sending it to the model. Customer data, analytics, PII—all stay isolated.

**Long-running processes** - Unlike serverless (30 second limits), sandboxes run for 45+ minutes. CI/CD pipelines, data processing, model training.

**Continuous learning** - Agents save working code as reusable "skills." They build libraries of capabilities without retraining the model.

**Dynamic workflows** - Instead of hard-coded workflows, agents create solutions on-demand. "Here's what I need. Let me write code to do it. Done."

Anthropic didn't just optimize performance. They discovered a new way to build with AI.

*Sandboxes are to AI agents what containers were to cloud computing.*

---

## Ready to Build?

Now that you understand what sandboxes are and why they matter, it's time to experience them firsthand.

Want to run your own sandbox? The hands-on tutorial shows you how to:
- Set up a local sandbox in 2 minutes
- Execute AI-generated code safely
- Build interactive examples
- Deploy to production

**[→ Read the Tutorial: Building with Sandboxes](/articles/building-with-sandboxes-tutorial)**

Or explore with Cloudflare directly:
- **[Cloudflare Sandbox Documentation](https://developers.cloudflare.com/sandbox/)** - Official setup guide
- **[Get Started Guide](https://developers.cloudflare.com/sandbox/get-started/)** - Quick start in 5 minutes

---

## Resources

**Learn More:**
- [Anthropic's Code Execution with MCP](https://www.anthropic.com/engineering/code-execution-with-mcp) - The article that started this exploration
- [Cloudflare Sandbox Documentation](https://developers.cloudflare.com/sandbox/) - Official docs and guides
- [Model Context Protocol](https://modelcontextprotocol.io/) - The standard for AI-tool integration

**Experiment:**
- Get started: [Cloudflare Sandbox Get Started Guide](https://developers.cloudflare.com/sandbox/get-started/)
- Quick start: `npm create cloudflare@latest my-sandbox -- --template=cloudflare/sandbox-sdk/examples/minimal`
- Custom worker code shown in Step 2 above (includes blog integration endpoint)
- Explore the [Cloudflare Sandbox SDK](https://github.com/cloudflare/sandbox-sdk) on GitHub

---

*Coming next: "Sandbox Architecture Deep Dive: How to Build Production AI Agents"*
